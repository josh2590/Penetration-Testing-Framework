from nmap import nmap
from prettytable import PrettyTable


def scan():
    ip = input('nmap> Enter Ip Address/ Network : ')

    try:
        nm = nmap.PortScanner()
        nm.scan(hosts=ip,  arguments='--script vuln')

        if not nm.all_hosts():
            print('nmap> No Host Found....')
        for host in nm.all_hosts():
            print('nmap> Vulnerabilities found on', host)
            display_table = PrettyTable(['Vulnerable'])
            ports = ['tcp', 'udp']
            for port in ports:
                if port in nm[host]:
                    for port_number in nm[host][port]:
                        if 'script' in nm[host][port][port_number]:
                            for key, val in nm[host][port][port_number]['script'].items():
                                if 'cve' in val.lower():
                                    display_table.add_row([val])
            print(display_table)
    except:
        print("nmap> Error in scanning network....")
